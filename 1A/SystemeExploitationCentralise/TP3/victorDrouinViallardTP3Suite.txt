===== TP3 - Exercice 1 =====
===== exercice253.c =====

#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <sys/types.h>
#include <sys/wait.h>

int main(void) {
	int pid;
	int status;
	
	/* Création du processus fils */
	pid = fork();
	
	/* Dans le processus fils faire... */
	if(pid == 0) {
		/* Imprimer les valeurs de retour de fork, getpid, getppid */
		printf("Fork : 0; Getpid : %d; Getppid : %d\n", getpid(), getppid());
		/* Bloquer 4 secondes le processus */
		sleep(4);
		/* Terminer par exit(2) */
		exit(2);
	}
	/* Fans le processus père faire... */
	else {
		/* Imprimer les valeurs de retour de fork, getpid, getppid */
		printf("Fork : %d; Getpid : %d; Getppid : %d\n", pid, getpid(), getppid());
		/* Attendre le retour du fils */
		pid = wait(&status);
		/* Imprimer le code de retour du fils (2 attendu) */
		printf("Fils %d retourne %d\n", pid, WEXITSTATUS(status));
		/* Exercuter l'autre programme C */
		execl("ps229", "ps229", (char *) NULL);
	}
	
	return 0;
}
===== ps229.c =====

#include <stdio.h>
#include <unistd.h>

int main(void) {
	
	execlp("ps", "ps", "-Al", (char *) NULL);
	
	return 0;
}


===== TP3 - Exercice 1 =====

#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <signal.h>
#include <sys/types.h>
#include <sys/wait.h>

int signals = 0;

void handler (int sig)
{
	printf("Signal reçu de numéro %d.\n", sig);
	
	/* Incrémenter le nombre de signaux reçus */
	signals++;
	
	/* S'arrêter si 5 signaux ont été reçus. */
	if(signals >= 5) {
		exit(0);
	}
}

int main(void) {
	int k;
	
	/* Connexion des signaux au handler */
	for(k = 1; k < 14; k++) {
		signal(k, handler);
	}
	for(k = 15; k < 31; k++) {
		signal(k, handler);
	}
	
	/* Attendre 27 secondes */
	for(k = 0; k < 9; k++) {
		sleep(3);
		printf("Et hop ! Trois secondes de plus.\n");
	}
	
	return 0;
}



